<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informações do colaborador</title>
    <style>
        #loadingScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
            border-radius: 8px;
            text-align: center;
        }

        #loadingLogo {
            width: 150px;
            animation: spin 6s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        #loadingText {
            margin-top: 20px;
            color: #ffffff;
            font-size: 18px;
        }

        #loadingFooter {
            margin-top: 10px;
            color: #ffffff;
            font-size: 14px;
        }

        #progressBar {
            width: 80%;
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
        }

        #progress {
            height: 100%;
            width: 0;
            background-color: #28a745;
            transition: width 0.3s;
        }

        #percentage {
            font-size: 20px;
            color: #ffffff;
            margin-top: 10px;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #e9ecef;
        }

        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        h1 {
            text-align: center;
            color: #343a40;
        }

        .logo {
            display: block;
            margin: 20px auto;
            max-width: 150px;
        }

        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
            color: #495057;
        }

        input[type="text"], input[type="tel"], input[type="email"], select, textarea {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            box-sizing: border-box;
        }

        textarea {
            height: 100px;
        }

        button {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            background-color: #007bff;
            border: none;
            color: #ffffff;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        .cpfCnpjField {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Informações do colaborador</h1>
        <img src="/gramado_verde-640w.webp" alt="Logo" class="logo">

        <form action="/formularios" method="POST" onsubmit="return validarFormulario();">
            <label for="nome">Nome Completo:</label>
            <input type="text" id="nome" name="nome" required> 

            <label for="tipoUsuario">Tipo de Usuário:</label>
            <select id="tipoUsuario" name="tipoUsuario" required onchange="mostrarCampoCpfCnpj()">
                <option value="" disabled selected>Selecione o tipo de usuário</option>
                <option value="Colaborador">Colaborador</option>
                <option value="Prestador de Serviços">Prestador de Serviços</option>
            </select>

            <div id="cpfField" class="cpfCnpjField">
                <label for="cpf">Digite seu CPF:</label>
                <input type="text" id="cpf" name="cpf" oninput="formatarCpf()" maxlength="14">
            </div>

            <div id="cnpjField" class="cpfCnpjField">
                <label for="cnpj">Digite seu CNPJ:</label>
                <input type="text" id="cnpj" name="cnpj" oninput="formatarCnpj()" maxlength="18">
            </div>

            <label for="rg">Digite seu RG:</label>
            <input type="text" id="rg" name="rg" required oninput="formatarRg()">

            <label for="telefone">Telefone:</label>
            <input type="tel" id="telefone" name="telefone" required>

            <label for="unidade">Unidade de Negócio:</label>
            <select id="unidade" name="unidade" required onchange="atualizarSetores()">
                <option value="" disabled selected>Selecione uma unidade</option>
                <option value="Snowland">Snowland</option>
                <option value="Acquamontion">Acquamontion</option>
                <option value="Buona Vitta">Buona Vitta</option>
                <option value="Bella">Bella</option>
                <option value="Escritório">Escritório</option>
            </select>

            <label for="setor">Informe Seu Setor:</label>
            <select id="setor" name="setor" required disabled>
                <option value="" disabled selected>Primeiro informe sua unidade de negócio</option>
            </select>

            <label for="cargo">Cargo:</label>
            <input type="text" id="cargo" name="cargo" required>

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>

            <label for="observacao">Observação:</label>
            <textarea id="observacao" name="observacao"></textarea>

            <button type="submit" id="submitButton">Gerar Termo</button>
        </form>

        <div id="loadingScreen">
            <img src="/LogoEfeito.png" alt="Logo girando" id="loadingLogo">
            <div id="loadingText">Estamos gerando o termo para você...</div>
            <div id="progressBar">
                <div id="progress"></div>
            </div>
            <div id="percentage">0%</div>
            <div id="loadingFooter">By Gramado Parks</div>
        </div>
    </div>

    <script>
        const setores = {
            "Snowland": [
                "Almoxarifado",
                "Artística",
                "Bilheteria",
                "CAC",
                "Caverna do Yeti",
                "Contabilidade",
                "Diretoria",
                "Engenharia",
                "Escola de Neve",
                "Estação de Esqui",
                "Fini",
                "Fotos",
                "Gestão Operacional",
                "Gerência",
                "Gruta",
                "Hot Café",
                "Ice Bar",
                "Lavanderia",
                "Manutenção",
                "Markenting",
                "Mini Hot",
                "Montanha de Neve",
                "Patinação",
                "Pizzaria",
                "Pub da Montanha",
                "Sala de Vendas",
                "Segurança",
                "Souvenir",
                "Suprimentos",
                "Supply Chain",
                "Tecnologia da Informação",
                "Vip",
                "Winebar"
            ],
            "Acquamontion": [
                "Setor 1",
                "Setor 2"
            ],
            "Buona Vitta": [
                "Setor 1",
                "Setor 2"
            ],
            "Bella": [
                "Setor 1",
                "Setor 2"
            ],
            "Escritório": [
                "Setor 1",
                "Setor 2"
            ]
        };

        function atualizarSetores() {
            const unidadeSelecionada = document.getElementById('unidade').value;
            const setorSelect = document.getElementById('setor');

            setorSelect.innerHTML = '<option value="" disabled selected>Selecione o setor</option>'; // Limpa as opções anteriores

            if (unidadeSelecionada && setores[unidadeSelecionada]) {
                setores[unidadeSelecionada].forEach(setor => {
                    const option = document.createElement('option');
                    option.value = setor;
                    option.textContent = setor;
                    setorSelect.appendChild(option);
                });
                setorSelect.disabled = false; // Habilita o campo de setor
            } else {
                setorSelect.disabled = true; // Desabilita o campo de setor
            }
        }

        function mostrarCampoCpfCnpj() {
            const tipoUsuario = document.getElementById('tipoUsuario').value;
            document.getElementById('cpfField').style.display = tipoUsuario === 'Colaborador' ? 'block' : 'none';
            document.getElementById('cnpjField').style.display = tipoUsuario === 'Prestador de Serviços' ? 'block' : 'none';
        }

        function formatarCpf() {
            const cpfField = document.getElementById('cpf');
            let cpf = cpfField.value.replace(/\D/g, '');
            if (cpf.length > 11) {
                cpf = cpf.slice(0, 11);
            }
            cpfField.value = cpf.replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{2})$/, '$1-$2');
        }

        function formatarCnpj() {
            const cnpjField = document.getElementById('cnpj');
            let cnpj = cnpjField.value.replace(/\D/g, '');
            if (cnpj.length > 14) {
                cnpj = cnpj.slice(0, 14);
            }
            cnpjField.value = cnpj.replace(/^(\d{2})(\d)/, '$1.$2').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d{1,2})$/, '$1/$2').replace(/(\d{2})$/, '$1-$2');
        }

        function formatarRg() {
            const rgField = document.getElementById('rg');
            let rg = rgField.value.replace(/\D/g, '');
            if (rg.length > 9) {
                rg = rg.slice(0, 9);
            }
            rgField.value = rg.replace(/(\d{1})(\d)/, '$1.$2').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d{1,1})$/, '$1-$2');
        }

        function validarFormulario() {
            const cpf = document.getElementById('cpf').value.replace(/\D/g, '');
            const cnpj = document.getElementById('cnpj').value.replace(/\D/g, '');
            const tipoUsuario = document.getElementById('tipoUsuario').value;

            if (tipoUsuario === 'Colaborador' && !validarCpf(cpf)) {
                alert('CPF inválido');
                return false;
            }

            if (tipoUsuario === 'Prestador de Serviços' && !validarCnpj(cnpj)) {
                alert('CNPJ inválido');
                return false;
            }

            mostrarTelaDeCarregamento();
            return true;
        }

        function validarCpf(cpf) {
            // Lógica de validação do CPF
            // ... (implementar a lógica de validação)
            return true; // Substitua pelo resultado da validação
        }

        function validarCnpj(cnpj) {
            // Lógica de validação do CNPJ
            // ... (implementar a lógica de validação)
            return true; // Substitua pelo resultado da validação
        }

        function mostrarTelaDeCarregamento() {
            const loadingScreen = document.getElementById('loadingScreen');
            const progress = document.getElementById('progress');
            const percentage = document.getElementById('percentage');
            let width = 0;

            loadingScreen.style.display = 'flex'; // Mostra a tela de carregamento

            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        window.location.href = '/formularios'; // Redireciona para a página de informações após o carregamento
                    }, 1000);
                } else {
                    width++;
                    progress.style.width = width + '%';
                    percentage.textContent = width + '%';
                }
            }, 60); // Aumenta a velocidade de carregamento conforme necessário
        }
    </script>
</body>
</html>
